═══════════════════════════════════════════════════
COPY INSTRUCTIONS - Catalog Studio Database Tables
═══════════════════════════════════════════════════

Files to Copy:
──────────────

DOCUMENTATION:
1. CatalogStudio-SprintPlan-v1.0.md
   FROM: MANUAL_COPY_FILES\CatalogStudio-SprintPlan-v1.0.md
   TO:   ClaudeDocumentation\contractUI\CatalogStudio-SprintPlan-v1.0.md

2. CatalogStudio-Database-Schema-v1.0.md
   FROM: MANUAL_COPY_FILES\CatalogStudio-Database-Schema-v1.0.md
   TO:   ClaudeDocumentation\contractUI\CatalogStudio-Database-Schema-v1.0.md

MIGRATIONS (Run in Supabase SQL Editor in order):
3. 001_create_cat_blocks.sql
   FROM: MANUAL_COPY_FILES\migrations\catalog-studio\001_create_cat_blocks.sql
   TO:   contractnest-edge\supabase\migrations\catalog-studio\001_create_cat_blocks.sql

4. 002_create_cat_templates.sql
   FROM: MANUAL_COPY_FILES\migrations\catalog-studio\002_create_cat_templates.sql
   TO:   contractnest-edge\supabase\migrations\catalog-studio\002_create_cat_templates.sql

5. 003_seed_master_data.sql
   FROM: MANUAL_COPY_FILES\migrations\catalog-studio\003_seed_master_data.sql
   TO:   contractnest-edge\supabase\migrations\catalog-studio\003_seed_master_data.sql

EDGE FUNCTIONS (Deploy via Supabase CLI):
6. cat-blocks/index.ts
   FROM: MANUAL_COPY_FILES\edge-functions\cat-blocks\index.ts
   TO:   contractnest-edge\supabase\functions\cat-blocks\index.ts

7. cat-templates/index.ts
   FROM: MANUAL_COPY_FILES\edge-functions\cat-templates\index.ts
   TO:   contractnest-edge\supabase\functions\cat-templates\index.ts

API FILES (Copy to contractnest-api):
8. catalogStudioTypes.ts
   FROM: MANUAL_COPY_FILES\api\catalog-studio\catalogStudioTypes.ts
   TO:   contractnest-api\src\types\catalogStudioTypes.ts

9. catBlocksService.ts
   FROM: MANUAL_COPY_FILES\api\catalog-studio\catBlocksService.ts
   TO:   contractnest-api\src\services\catBlocksService.ts

10. catTemplatesService.ts
    FROM: MANUAL_COPY_FILES\api\catalog-studio\catTemplatesService.ts
    TO:   contractnest-api\src\services\catTemplatesService.ts

11. catalogStudioController.ts
    FROM: MANUAL_COPY_FILES\api\catalog-studio\catalogStudioController.ts
    TO:   contractnest-api\src\controllers\catalogStudioController.ts

12. catalogStudioRoutes.ts
    FROM: MANUAL_COPY_FILES\api\catalog-studio\catalogStudioRoutes.ts
    TO:   contractnest-api\src\routes\catalogStudioRoutes.ts

13. index.ts (API module entry)
    FROM: MANUAL_COPY_FILES\api\catalog-studio\index.ts
    TO:   contractnest-api\src\modules\catalog-studio\index.ts

═══════════════════════════════════════════════════
Submodules Affected:
──────────────
- ClaudeDocumentation (Sprint plan + DB schema documents)
- contractnest-edge (Migration SQL files + Edge functions)
- contractnest-api (API routes, controllers, services)

═══════════════════════════════════════════════════
Tables Created:
──────────────
1. cat_blocks - Global blocks library (service, spare, billing, etc.)
2. cat_templates - Templates built from blocks (tenant + global)

Master Data Seeded (in m_category_master/details):
- cat_block_type (8 types)
- cat_pricing_mode (4 modes)
- cat_price_type (5 types)
- cat_block_status (3 statuses)
- cat_template_status (3 statuses)
- cat_evidence_type (7 types)
- cat_location_type (3 types)
- cat_currency (6 currencies)
- cat_payment_type (5 types)

═══════════════════════════════════════════════════
Edge Functions Created:
──────────────
1. cat-blocks - Global blocks CRUD
   - GET /cat-blocks - List all blocks (filtered by is_admin)
   - GET /cat-blocks/:id - Get single block
   - POST /cat-blocks - Create block (admin only)
   - PATCH /cat-blocks/:id - Update block (admin only)
   - DELETE /cat-blocks/:id - Soft delete (admin only)

2. cat-templates - Templates CRUD with tenant isolation
   - GET /cat-templates - List tenant templates
   - GET /cat-templates/system - List system templates
   - GET /cat-templates/public - List public templates
   - GET /cat-templates/:id - Get single template
   - POST /cat-templates - Create template
   - POST /cat-templates/:id/copy - Copy system template to tenant
   - PATCH /cat-templates/:id - Update template
   - DELETE /cat-templates/:id - Soft delete

Required Headers:
- x-signature (HMAC signature using INTERNAL_SIGNING_SECRET)
- x-timestamp (Unix timestamp for replay protection)
- x-tenant-id (Tenant UUID)
- x-user-id (User UUID)
- x-product (default: contractnest)
- x-is-admin (true/false)
- x-environment (live/test) - for cat-templates only

═══════════════════════════════════════════════════
API Endpoints (via Express):
──────────────
Base: /api/catalog-studio

BLOCKS:
  GET    /blocks           - List blocks (filtered by isAdmin)
  GET    /blocks/:id       - Get single block
  POST   /blocks           - Create block (admin only)
  PATCH  /blocks/:id       - Update block (admin only)
  DELETE /blocks/:id       - Soft delete (admin only)

TEMPLATES:
  GET    /templates        - List tenant templates
  GET    /templates/system - List system templates
  GET    /templates/public - List public templates
  GET    /templates/:id    - Get single template
  POST   /templates        - Create template
  POST   /templates/:id/copy - Copy system template
  PATCH  /templates/:id    - Update template
  DELETE /templates/:id    - Soft delete

HEALTH:
  GET    /health           - Health check

═══════════════════════════════════════════════════
Integration in contractnest-api/src/index.ts:
──────────────
Add the following to register routes:

  import catalogStudioRoutes from './routes/catalogStudioRoutes';

  // In route registration section:
  app.use('/api/catalog-studio', authenticate, catalogStudioRoutes);

═══════════════════════════════════════════════════
