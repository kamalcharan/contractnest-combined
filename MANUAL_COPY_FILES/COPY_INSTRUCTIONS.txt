═══════════════════════════════════════════════════════════════════════════════
COMPLETE MANUAL COPY INSTRUCTIONS
Feature: BBB Profile Onboarding + Admin Dashboard + n8n Integration
Branch: claude/review-ai-bot-code-01Kn4TLm8FefBpZ8RvcxaUSf
Date: 2025-12-01
═══════════════════════════════════════════════════════════════════════════════

SUBMODULES AFFECTED:
─────────────────────────────────────────────────────────────────────────────
- contractnest-ui (18 files)
- contractnest-edge (1 file)
- contractnest-api (3 files)
- n8n-workflows (2 files - import to n8n separately)

═══════════════════════════════════════════════════════════════════════════════
SECTION 1: CONTRACTNEST-UI FILES (18 files)
═══════════════════════════════════════════════════════════════════════════════

# App & Context
1.  src/App.tsx
2.  src/context/AuthContext.tsx

# BBB Components (NEW)
3.  src/components/VaNi/bbb/BBBMemberTable.tsx
4.  src/components/VaNi/bbb/ProfileEntryForm.tsx
5.  src/components/VaNi/bbb/AIEnhancementSection.tsx (from root MANUAL_COPY_FILES)
6.  src/components/VaNi/bbb/WebsiteScrapingForm.tsx (from root MANUAL_COPY_FILES)
7.  src/components/VaNi/bbb/SemanticClustersForm.tsx (NEW - cluster management)

# Pages (NEW)
7.  src/pages/VaNi/channels/BBBAdminDashboard.tsx
8.  src/pages/VaNi/channels/BBBProfileOnboardingPage.tsx

# VaNi Channel Pages (UPDATED)
9.  src/vani/pages/channels/ChatBotIntegrationPage.tsx
10. src/vani/pages/channels/WebsiteIntegrationPage.tsx
11. src/vani/pages/channels/WhatsAppIntegrationPage.tsx

# Services (NEW)
12. src/services/groupsService.ts
13. src/services/analytics.service.ts

# Hooks (NEW/UPDATED)
14. src/hooks/queries/useGroupQueries.ts
15. src/hooks/queries/useServiceCatalogQueries.ts
16. src/hooks/useResources.ts

# Utils
17. src/utils/requestQueue.ts
18. src/utils/resourceTransforms.ts

# Service Catalog Components
19. src/components/catalog/ServiceForm/ServiceConfigStep.tsx
20. src/components/catalog/ServiceForm/index.tsx

═══════════════════════════════════════════════════════════════════════════════
SECTION 2: CONTRACTNEST-EDGE FILES (1 file)
═══════════════════════════════════════════════════════════════════════════════

1. supabase/functions/groups/index.ts (NEW - create groups folder)

═══════════════════════════════════════════════════════════════════════════════
SECTION 3: CONTRACTNEST-API FILES (3 files)
═══════════════════════════════════════════════════════════════════════════════

1. src/config/VaNiN8NConfig.ts (NEW - create config folder)
2. src/services/groupsService.ts (NEW)
3. src/controllers/groupsController.ts (NEW)

═══════════════════════════════════════════════════════════════════════════════
SECTION 4: N8N WORKFLOWS (3 files - import via n8n dashboard)
═══════════════════════════════════════════════════════════════════════════════

1. n8n-workflows/process-profile.json (import to n8n dashboard)
2. n8n-workflows/generate-clusters.json (NEW - import to n8n dashboard)
3. n8n-workflows/IMPORT_INSTRUCTIONS.md (reference guide)

═══════════════════════════════════════════════════════════════════════════════
FEATURE SUMMARY
═══════════════════════════════════════════════════════════════════════════════

1. BBB Profile Onboarding Page
   - Profile entry form with AI enhancement
   - Website scraping to auto-generate profiles
   - "Let me in" dialog for membership creation
   - Rich text editor for profile descriptions
   - Embedding generation via n8n

2. BBB Admin Dashboard
   - Member table with search/filter
   - Status management (draft, active, suspended, inactive)
   - Admin edit modal for member profiles
   - Cross-tenant RLS support

3. Semantic Clusters (NEW)
   - After profile save, cluster form opens automatically
   - "Generate Clusters with AI" button triggers n8n
   - User can review, edit, and add custom clusters manually
   - Clusters saved to t_semantic_clusters table
   - Used for enhanced WhatsApp bot search

4. n8n Integration
   - Webhook for profile enhancement (/webhook/process-profile)
   - Webhook for embedding generation (/webhook/generate-embedding)
   - Webhook for cluster generation (/webhook/generate-clusters) [READY]
   - OpenAI integration for AI processing (GPT-4o-mini)

5. WhatsApp Integration Page
   - Business profile check before configuration
   - Updated flow for channel setup

═══════════════════════════════════════════════════════════════════════════════
N8N WORKFLOW: /webhook/generate-clusters (IMPLEMENTED)
File: n8n-workflows/generate-clusters.json
═══════════════════════════════════════════════════════════════════════════════

IMPORT INSTRUCTIONS:
1. Open n8n dashboard
2. Click "Import" or "Add workflow"
3. Select generate-clusters.json file
4. Update OpenAI credential ID (replace OPENAI_CREDENTIAL_ID)
5. Activate the workflow

Input (POST to /webhook/generate-clusters):
{
  "membership_id": "uuid",
  "profile_text": "business description text",
  "keywords": ["keyword1", "keyword2"]
}

Output:
{
  "success": true,
  "membership_id": "uuid",
  "clusters_generated": 3,
  "clusters": [
    {
      "primary_term": "accounting",
      "related_terms": ["bookkeeping", "tax filing", "GST", "audit", "CA", "ITR", "tax consultant", "chartered accountant"],
      "category": "Services",
      "confidence_score": 0.95
    }
  ]
}

Workflow Nodes:
1. Webhook Trigger - Receives POST request
2. Validate Input - Validates membership_id and profile_text
3. Generate Clusters (GPT) - Calls GPT-4o-mini with optimized prompt
4. Format Response - Parses and validates clusters
5. Respond to Webhook - Returns JSON response
6. Error Handler - Handles failures gracefully

GPT Prompt (optimized for Indian business context):
- Generates 3-5 semantic clusters per profile
- Includes 10-15 related terms per cluster
- Considers Hindi/regional transliterations
- Includes common misspellings and customer search terms
- Categories: Technology, Healthcare, Services, Manufacturing, etc.

═══════════════════════════════════════════════════════════════════════════════
